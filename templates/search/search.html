{% extends "base.html" %}
{% load highlight %}

{% block content %}
    {% if query %}
        <script type='text/javascript'>
            google.load('visualization', '1', {'packages':['table']});
            google.setOnLoadCallback(drawTable);

            function drawTable() {

                var data = new google.visualization.DataTable();

                data.addColumn('string', 'HIT Title');
                data.addColumn('number', 'Reward');
                data.addColumn('datetime', 'Posted');

                {% with page.object_list as results %}
                    {% for result in results %}
                        {% with result.occurrence_date as date %}
                    data.addRow(['{{ result.title|safe }}', 
                                 {{ result.reward|safe}},
                                 new Date({{ date.year }},
                                          {{ date.month }},
                                          {{ date.day }},
                                          {{ date.hour }},
                                          {{ date.minute }},
                                          {{ date.second }})
                            ]);
                         {% endwith %}
                    {% endfor %}
                {% endwith %}

                var table = new google.visualization.Table(document.getElementById('table_div'));
                table.draw(data, {
                            showRowNumber: true, 
                            firstRowNumber: {{ page.start_index }}, 
                            allowHtml: true, 
                            page: 'disable', 
                            width: '100%', 
                            alternatingRowStyle: true 
                          });
            }
        </script>
        <div id="table_div"></div>
        {% if page.has_previous or page.has_next %}
            <div>
                {% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
                |
                {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
            </div>
        {% endif %}
    {% else %}
        {# Show some example queries to run, maybe query syntax, something else? #}
    {% endif %}
{% endblock %}
